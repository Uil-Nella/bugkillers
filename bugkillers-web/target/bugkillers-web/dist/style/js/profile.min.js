function scoreChange(a){function e(){var b=document.getElementById("doughnutChartCanvas").getContext("2d");new Chart(b).Doughnut(c,d),$("#resumeScore .scoreVal span").text(a).parent().fadeIn(200),100==a?$("#resumeScore .which span").html('<a href="'+ctx+'/jobs/list_所有职位">马上去投递</a>'):$("#resumeScore .which span").html("<a>马上去完善</a>")}var b=360*parseInt(a)/100,c=[{value:b,color:"#009a6d"},{value:360-b,color:"#ffffff"}],d={percentageInnerCutout:80,segmentShowStroke:!1,animationEasing:"easeOutQuart"};setTimeout(e,300)}function changeAllIds(a){var c,d,e,f,b=JSON.parse(a);$("#resumeId").val(b.resumeId.n),c=b.expId,d=b.eduId,e=b.projectId,f=b.showId,$("#workExperience .wlist li").each(function(){var b,a=$(this).attr("data-id");for(b=0;b<c.length;b++)a==c[b].o&&$(this).attr("data-id",c[b].n)}),$("#projectExperience .plist li").each(function(){var b,a=$(this).attr("data-id");for(b=0;b<e.length;b++)a==e[b].o&&$(this).attr("data-id",e[b].n)}),$("#educationalBackground .elist li").each(function(){var b,a=$(this).attr("data-id");for(b=0;b<d.length;b++)a==d[b].o&&$(this).attr("data-id",d[b].n)}),$("#worksShow .slist li").each(function(){var b,a=$(this).attr("data-id");for(b=0;b<f.length;b++)a==f[b].o&&$(this).attr("data-id",f[b].n)})}function openYear(a){$(".profile_select_normal").removeClass("select_focus"),$(".boxUpDown").hide(),$(".select_"+a).addClass("select_focus"),$(".box_"+a).show()}function selectYear(a,b){$(".select_"+a).val(b).css("color","#333").removeClass("select_focus"),$("."+a).val(b),$(".box_"+a).hide()}function suggestCompany(a,b){var c="";$.ajax({type:"POST",async:!1,url:ctx+"/c/companySearchCompanyLs.json",data:{kd:a},dataType:"json"}).done(function(a){c=a}),$(b).autocomplete({source:c})}function suggestPosition(a,b){var c="";$.ajax({type:"POST",async:!1,url:ctx+"/jobs/listLs",data:{pl:a},dataType:"json"}).done(function(a){a.success&&(c=a.content.result)}),$(b).autocomplete({source:c})}function click_scroll(a){var b=$("#"+a).offset();switch(a){case"expectJob":$("#expectJob .expectAdd").trigger("click");break;case"workExperience":$("#workExperience .experienceAdd").trigger("click");break;case"projectExperience":$("#projectExperience .projectAdd").trigger("click");break;case"educationalBackground":$("#educationalBackground .educationalAdd").trigger("click");break;case"selfDescription":$("#selfDescription .descriptionAdd").trigger("click");break;case"worksShow":$("#worksShow .workAdd").trigger("click");break;default:return}$("body,html").animate({scrollTop:b.top},400,function(){$("#"+a).animate({borderColor:"#e46a4a"},300,function(){$(this).animate({borderColor:"transparent"})})})}function img_check(a,b,c){var a=$("#"+c);this.AllowExt=".jpg,.gif,.jpeg,.png,.pjpeg",this.FileExt=a.val().substr(a.val().lastIndexOf(".")).toLowerCase(),0!=this.AllowExt&&-1==this.AllowExt.indexOf(this.FileExt)?errorTips("只支持jpg、gif、png、jpeg格式，请重新上传","上传头像"):($("#"+c+"_error").text("").hide(),$.ajaxFileUpload({url:b,secureuri:!1,fileElementId:c,data:{headPic:a.val()},dataType:"json",success:function(a){if(a.success){var b=a.content;$("#portraitShow img").attr("src",ctx+"/"+b),$("#basicInfo .basicShow img").attr("src",ctx+"/"+b),$("#portraitNo").hide(),$("#portraitShow").show()}else errorTips("上传失败，请重新上传","上传头像")},error:function(){errorTips("上传失败，请重新上传","上传头像")}}))}function file_check(obj,action_url,id){var userId;$("#loadingImg").css("visibility","visible"),obj=$("#"+id),userId=$("#userid").val(),this.AllowExt=".doc,.docx,.pdf,.ppt,.pptx,.txt,.wps",this.FileExt=obj.val().substr(obj.val().lastIndexOf(".")).toLowerCase(),0!=this.AllowExt&&-1==this.AllowExt.indexOf(this.FileExt)?(errorTips("只支持word、pdf、ppt、txt、wps格式文件，请重新上传"),$("#loadingImg").css("visibility","hidden")):$.ajaxFileUpload({type:"POST",url:action_url,secureuri:!1,fileElementId:id,data:{userId:userId},dataType:"text",success:function(jsonStr){var html,json=eval("("+jsonStr+")");$("#loadingImg").css("visibility","hidden"),json.success?(html='<a href="'+ctx+'/nearBy/downloadResume" class="resume_download" title="下载'+json.content.nearbyName+'">'+json.content.nearbyName+"</a>"+'<a  class="fr del" href="javascript:;">删除</a><br /><span class="c9">上传时间：'+json.content.time+"</span>",$("#myResume .resumeUploadDiv").html(html),$("#myResume h2 a").html("重新上传"),$.colorbox({inline:!0,href:$("div#uploadFileSuccess"),title:"上传附件简历"})):-1==json.code?$.colorbox({inline:!0,href:$("div#fileResumeUpload"),title:"附件简历上传失败"}):-2==json.code?$.colorbox({inline:!0,href:$("div#fileResumeUploadSize"),title:"附件简历上传失败"}):(errorTips("简历上传失败，请重新上传"),$("#loadingImg").css("visibility","hidden"))},error:function(){errorTips("简历上传失败，请重新上传"),$("#loadingImg").css("visibility","hidden")}})}!function(a,b){function c(a,b,c){var d=k[b.type]||{};return null==a?c||!b.def?null:b.def:(a=d.floor?~~a:parseFloat(a),isNaN(a)?b.def:d.mod?(a+d.mod)%d.mod:0>a?0:d.max<a?d.max:a)}function d(b){var c=i(),d=c._rgba=[];return b=b.toLowerCase(),o(h,function(a,e){var f,g=e.re.exec(b),h=g&&e.parse(g),i=e.space||"rgba";return h?(f=c[i](h),c[j[i].cache]=f[j[i].cache],d=c._rgba=f._rgba,!1):void 0}),d.length?("0,0,0,0"===d.join()&&a.extend(d,n.transparent),c):n[b]}function e(a,b,c){return c=(c+1)%1,1>6*c?a+6*(b-a)*c:1>2*c?b:2>3*c?a+6*(b-a)*(2/3-c):a}var n,f="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",g=/^([\-+])=\s*(\d+\.?\d*)/,h=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],a[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(a){return[a[1],a[2]/100,a[3]/100,a[4]]}}],i=a.Color=function(b,c,d,e){return new a.Color.fn.parse(b,c,d,e)},j={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},k={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},l=i.support={},m=a("<p>")[0],o=a.each;m.style.cssText="background-color:rgba(1,1,1,.5)",l.rgba=m.style.backgroundColor.indexOf("rgba")>-1,o(j,function(a,b){b.cache="_"+a,b.props.alpha={idx:3,type:"percent",def:1}}),i.fn=a.extend(i.prototype,{parse:function(e,f,g,h){if(e===b)return this._rgba=[null,null,null,null],this;(e.jquery||e.nodeType)&&(e=a(e).css(f),f=b);var k=this,l=a.type(e),m=this._rgba=[];return f!==b&&(e=[e,f,g,h],l="array"),"string"===l?this.parse(d(e)||n._default):"array"===l?(o(j.rgba.props,function(a,b){m[b.idx]=c(e[b.idx],b)}),this):"object"===l?(e instanceof i?o(j,function(a,b){e[b.cache]&&(k[b.cache]=e[b.cache].slice())}):o(j,function(b,d){var f=d.cache;o(d.props,function(a,b){if(!k[f]&&d.to){if("alpha"===a||null==e[a])return;k[f]=d.to(k._rgba)}k[f][b.idx]=c(e[a],b,!0)}),k[f]&&a.inArray(null,k[f].slice(0,3))<0&&(k[f][3]=1,d.from&&(k._rgba=d.from(k[f])))}),this):void 0},is:function(a){var b=i(a),c=!0,d=this;return o(j,function(a,e){var f,g=b[e.cache];return g&&(f=d[e.cache]||e.to&&e.to(d._rgba)||[],o(e.props,function(a,b){return null!=g[b.idx]?c=g[b.idx]===f[b.idx]:void 0})),c}),c},_space:function(){var a=[],b=this;return o(j,function(c,d){b[d.cache]&&a.push(c)}),a.pop()},transition:function(a,b){var d=i(a),e=d._space(),f=j[e],g=0===this.alpha()?i("transparent"):this,h=g[f.cache]||f.to(g._rgba),l=h.slice();return d=d[f.cache],o(f.props,function(a,e){var f=e.idx,g=h[f],i=d[f],j=k[e.type]||{};null!==i&&(null===g?l[f]=i:(j.mod&&(i-g>j.mod/2?g+=j.mod:g-i>j.mod/2&&(g-=j.mod)),l[f]=c((i-g)*b+g,e)))}),this[e](l)},blend:function(b){if(1===this._rgba[3])return this;var c=this._rgba.slice(),d=c.pop(),e=i(b)._rgba;return i(a.map(c,function(a,b){return(1-d)*e[b]+d*a}))},toRgbaString:function(){var b="rgba(",c=a.map(this._rgba,function(a,b){return null==a?b>2?1:0:a});return 1===c[3]&&(c.pop(),b="rgb("),b+c.join()+")"},toHslaString:function(){var b="hsla(",c=a.map(this.hsla(),function(a,b){return null==a&&(a=b>2?1:0),b&&3>b&&(a=Math.round(100*a)+"%"),a});return 1===c[3]&&(c.pop(),b="hsl("),b+c.join()+")"},toHexString:function(b){var c=this._rgba.slice(),d=c.pop();return b&&c.push(~~(255*d)),"#"+a.map(c,function(a){return a=(a||0).toString(16),1===a.length?"0"+a:a}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),i.fn.parse.prototype=i.fn,j.hsla.to=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var k,l,b=a[0]/255,c=a[1]/255,d=a[2]/255,e=a[3],f=Math.max(b,c,d),g=Math.min(b,c,d),h=f-g,i=f+g,j=.5*i;return k=g===f?0:b===f?60*(c-d)/h+360:c===f?60*(d-b)/h+120:60*(b-c)/h+240,l=0===h?0:.5>=j?h/i:h/(2-i),[Math.round(k)%360,l,j,null==e?1:e]},j.hsla.from=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var b=a[0]/360,c=a[1],d=a[2],f=a[3],g=.5>=d?d*(1+c):d+c-d*c,h=2*d-g;return[Math.round(255*e(h,g,b+1/3)),Math.round(255*e(h,g,b)),Math.round(255*e(h,g,b-1/3)),f]},o(j,function(d,e){var f=e.props,h=e.cache,j=e.to,k=e.from;i.fn[d]=function(d){if(j&&!this[h]&&(this[h]=j(this._rgba)),d===b)return this[h].slice();var e,g=a.type(d),l="array"===g||"object"===g?d:arguments,m=this[h].slice();return o(f,function(a,b){var d=l["object"===g?a:b.idx];null==d&&(d=m[b.idx]),m[b.idx]=c(d,b)}),k?(e=i(k(m)),e[h]=m,e):i(m)},o(f,function(b,c){i.fn[b]||(i.fn[b]=function(e){var k,f=a.type(e),h="alpha"===b?this._hsla?"hsla":"rgba":d,i=this[h](),j=i[c.idx];return"undefined"===f?j:("function"===f&&(e=e.call(this,j),f=a.type(e)),null==e&&c.empty?this:("string"===f&&(k=g.exec(e),k&&(e=j+parseFloat(k[2])*("+"===k[1]?1:-1))),i[c.idx]=e,this[h](i)))})})}),i.hook=function(b){var c=b.split(" ");o(c,function(b,c){a.cssHooks[c]={set:function(b,e){var f,g,h="";if("transparent"!==e&&("string"!==a.type(e)||(f=d(e)))){if(e=i(f||e),!l.rgba&&1!==e._rgba[3]){for(g="backgroundColor"===c?b.parentNode:b;(""===h||"transparent"===h)&&g&&g.style;)try{h=a.css(g,"backgroundColor"),g=g.parentNode}catch(j){}e=e.blend(h&&"transparent"!==h?h:"_default")}e=e.toRgbaString()}try{b.style[c]=e}catch(j){}}},a.fx.step[c]=function(b){b.colorInit||(b.start=i(b.elem,c),b.end=i(b.end),b.colorInit=!0),a.cssHooks[c].set(b.elem,b.start.transition(b.end,b.pos))}})},i.hook(f),a.cssHooks.borderColor={expand:function(a){var b={};return o(["Top","Right","Bottom","Left"],function(c,d){b["border"+d+"Color"]=a}),b}},n=a.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),$(function(){function e(){$(".projectForm").each(function(){$(this).validate({groups:{projectStart:"projectYearStart projectMonthStart",projectEnd:"projectYearEnd projectMonthEnd"},rules:{projectName:{required:!0,maxlenStr:100},thePost:{required:!0,maxlenStr:100},projectYearStart:{required:!0,checkProjectYear:!0},projectMonthStart:{required:!0,checkProjectYear:!0},projectYearEnd:{required:!0,checkProjectYear:!0},projectMonthEnd:{required:function(){return"至今"==$(".projectYearEnd").val()?!1:!0},checkProjectYear:!0},projectDescription:{required:!1}},messages:{projectName:{required:"请输入项目名称",maxlenStr:"请输入有效的项目名称"},thePost:{required:"请输入担任职务",maxlenStr:"请输入有效的担任职务"},projectYearStart:{required:"请选择开始时间",checkProjectYear:"开始时间需早于结束时间"},projectMonthStart:{required:"请选择开始时间",checkProjectYear:"开始时间需早于结束时间"},projectYearEnd:{required:"请选择结束时间",checkProjectYear:"结束时间需晚于开始时间"},projectMonthEnd:{required:"请选择结束时间",checkProjectYear:"结束时间需晚于开始时间"}},errorPlacement:function(a,b){"projectYearStart"==b.attr("name")||"projectMonthStart"==b.attr("name")||"projectYearEnd"==b.attr("name")||"projectMonthEnd"==b.attr("name")?a.appendTo($(b).parent().parent()):a.insertAfter(b)},submitHandler:function(a){var b=$('input[name="projectName"]',a).val(),c=$('input[name="thePost"]',a).val(),e=$('input[name="projectYearStart"]',a).val(),f=$('input[name="projectMonthStart"]',a).val(),g=$('input[name="projectYearEnd"]',a).val(),h=$('input[name="projectMonthEnd"]',a).val(),i="项目描述"!=$('textarea[name="projectDescription"]',a).val()?$('textarea[name="projectDescription"]',a).val():"",j=$(".projectId",a).val(),l=$("#resumeId").val(),m=$("#resubmitToken").val();$(a).find(":submit").val("保存中...").attr("disabled",!0),$.ajax({url:ctx+"/projectExperience/save.json",type:"POST",data:{projectName:b,positionName:c,startYear:e,startMonth:f,endYear:g,endMonth:h,projectRemark:i,projectid:j,id:l,resubmitToken:m},dataType:"json"}).done(function(b){var c,e;$("#resubmitToken").val(b.resubmitToken),b.success?(c=b.content.projectExperience,e="",3==b.code?""!=c?(e+='<li data-id="'+c.id+'">',e+='<div class="projectList"><i class="sm_del dn"></i><i class="sm_edit dn"></i><div class="f16 mb10" data-proName="'+c.projectName+'" data-posName="'+c.positionName+'" data-startY="'+c.startYear+'" data-startM="'+c.startMonth+'" data-endY="'+c.endYear+'"'+'data-endM="'+c.endMonth+'">'+c.projectNameAndRemark+'<span class="c9">（'+c.startDate+"-"+c.endDate+"）</span></div>",""!=c.projectRemark&&(e+='<div class="dl1">'+c.projectRemark+"</div>"),e+="</div></li>",""!=$.trim(d.obj.children(".projectShow").children(".plist").html())&&$(a).remove(),d.obj.children(".c_add").removeClass("dn"),d.obj.children(".projectShow").children(".plist").prepend(e),d.obj.children(".projectShow").removeClass("dn"),d.obj.children(".projectEdit").addClass("dn")):""!=$.trim(d.obj.children(".projectShow").children(".plist").html())?($(a).remove(),d.obj.children(".c_add").removeClass("dn")):(d.obj.children(".projectEdit").addClass("dn"),d.obj.children(".projectAdd").removeClass("dn")):4==b.code?(e+='<div class="projectList"><i class="sm_del dn"></i><i class="sm_edit dn"></i><div class="f16 mb10" data-proName="'+c.projectName+'" data-posName="'+c.positionName+'" data-startY="'+c.startYear+'" data-startM="'+c.startMonth+'" data-endY="'+c.endYear+'"'+'data-endM="'+c.endMonth+'">'+c.projectNameAndRemark+'<span class="c9">（'+c.startDate+"-"+c.endDate+"）</span></div>",""!=c.projectRemark&&(e+='<div class="dl1">'+c.projectRemark+"</div>"),e+="</div>",$(a).parent("li").html(e)):2==b.code&&($(a).parent("li").remove(),0==d.obj.children(".projectShow").children(".plist").children("li").length&&d.AddCancel),d.obj.find(".plist li:last-child").addClass("noborder"),$("#lastChangedTime span").text(b.content.refreshTime),$("#resumeScore .which div").text(b.content.infoCompleteStatus.msg),$("#resumeScore .which span").attr("rel",b.content.infoCompleteStatus.nextStage),scoreChange(b.content.infoCompleteStatus.score),k(d.obj),b.content.isNew&&changeAllIds(b.content.jsonIds)):alert(b.msg),$(a).find(":submit").val("保 存").attr("disabled",!1)})}})})}function i(){$(".workForm").each(function(){$(this).validate({rules:{workLink:{required:!1,checkUrlNot:!0,maxlength:150},workDescription:{required:!1,maxlength:100}},messages:{workLink:{checkUrlNot:"请输入有效的作品链接",maxlength:"请输入有效的作品链接"},workDescription:{maxlength:"请输入100字以内的有效作品说明"}},submitHandler:function(a){var b="请输入作品链接"!=$('input[name="workLink"]',a).val()?$('input[name="workLink"]',a).val():"",c="请输入说明文字"!=$('textarea[name="workDescription"]',a).val()?$('textarea[name="workDescription"]',a).val():"",d=$(".showId",a).val(),e=$("#resumeId").val(),f=$("#resubmitToken").val();$(a).find(":submit").val("保存中...").attr("disabled",!0),$.ajax({url:ctx+"/workShow/save.json",type:"POST",data:{url:b,workName:c,wsid:d,id:e,resubmitToken:f},dataType:"json"}).done(function(b){var c,d,e;$("#resubmitToken").val(b.resubmitToken),b.success?(c="",d="",e=b.content.workShow,3==b.code?""!=e?(c+='<li data-id="'+e.id+'"><div class="workList c7">'+'<i class="sm_del dn"></i>'+'<i class="sm_edit dn"></i>',e.url&&(d="http://"==e.url.substring(0,7)||"https://"==e.url.substring(0,8)?e.url:"http://"+e.url,c+='<div class="f16">网址：<a href="'+d+'" target="_blank">'+e.url+"</a></div>"),c+="<p>"+e.workName+"</p>"+"</div></li>",placeholderFn(),""!=$.trim(h.obj.children(".workShow").children(".slist").html())&&$(a).remove(),h.obj.children(".workShow").children(".slist").prepend(c),h.obj.children(".workShow").removeClass("dn"),h.obj.children(".workEdit").addClass("dn"),h.obj.children(".c_add").removeClass("dn")):""!=$.trim(h.obj.children(".workShow").children(".slist").html())?($(a).remove(),h.obj.children(".c_add").removeClass("dn")):(h.obj.children(".workEdit").addClass("dn"),h.obj.children(".workAdd").removeClass("dn")):4==b.code?(c+='<div class="workList c7"><i class="sm_del dn"></i><i class="sm_edit dn"></i>',e.url&&(d="http://"==e.url.substring(0,7)||"https://"==e.url.substring(0,8)?e.url:"http://"+e.url,c+='<div class="f16">网址：<a href="'+d+'" target="_blank">'+e.url+"</a></div>"),c+="<p>"+e.workName+"</p>"+"</div>",placeholderFn(),$(a).parent("li").html(c)):2==b.code&&($(a).parent("li").remove(),""==$.trim(h.obj.children(".workShow").children(".slist").html())&&h.AddCancel),h.obj.find(".slist li:last-child").addClass("noborder"),$("#lastChangedTime span").text(b.content.refreshTime),$("#resumeScore .which div").text(b.content.infoCompleteStatus.msg),$("#resumeScore .which span").attr("rel",b.content.infoCompleteStatus.nextStage),scoreChange(b.content.infoCompleteStatus.score),k(h.obj),b.content.isNew&&changeAllIds(b.content.jsonIds)):alert(b.msg),$(a).find(":submit").val("保 存").attr("disabled",!1)})}})})}function j(){a=!1}function k(){a=!0}var b,c,d,f,g,h,a=!0;window.onbeforeunload=function(){return a?void 0:"内容还未保存，确认离开该页面吗？ "},$(".profile_radio li input").click(function(){$(this).parent("li").siblings("li").removeClass("current"),$(this).parent("li").addClass("current")}),$(document).click(function(){$(".boxUpDown").hide().prev("input").removeClass("select_focus")}),$("#resumeScore .which span").bind("click",function(){var a=$(this).attr("rel");"complete"!=a&&click_scroll(a)}),jQuery.validator.addMethod("checkWorkYear",function(a,b){var c=$(b).parents(".experienceForm"),d=c.find(".companyYearStart").val(),e=c.find(".companyMonthStart").val(),f=c.find(".companyYearEnd").val(),g=c.find(".companyMonthEnd").val();return d>f?!1:d==f&&e>g?!1:!0},"开始时间需早于结束时间"),jQuery.validator.addMethod("checkProjectYear",function(a,b){var c=$(b).parents(".projectForm"),d=c.find(".projectYearStart").val(),e=c.find(".projectMonthStart").val(),f=c.find(".projectYearEnd").val(),g=c.find(".projectMonthEnd").val();return d>f?!1:d==f&&e>g?!1:!0},"开始时间需早于结束时间"),jQuery.validator.addMethod("checkSchoolYear",function(a,b){var c=$(b).parents(".educationalForm"),d=c.find(".schoolYearStart").val(),e=c.find(".schoolYearEnd").val();return d>e?!1:!0},"开始时间需小于结束时间"),$("#resume_name .nameShow .rename").bind("click",function(){$(this).parent().addClass("dn"),$(this).parent().siblings("form").removeClass("dn"),j($("#resume_name"))}),$("#resumeNameForm").validate({rules:{resumeName:{required:!0,checkNum:!0,maxlenStr:100}},messages:{resumeName:{required:"请输入简历名称",checkNum:"请输入有效的简历名称",maxlenStr:"请输入100字以内的简历名称"}},errorPlacement:function(a,b){a.appendTo($(b).parent())},submitHandler:function(a){var b=$('input[name="resumeName"]',a).val(),c=$("#resumeId").val();$(a).find(":submit").attr("disabled",!0),$.ajax({url:ctx+"/resume/renameResume.json",type:"POST",data:{resumeName:b,id:c}}).done(function(b){if(b.success){var c="";c=b.content.resumeName.length>18?b.content.resumeName.substring(0,15)+"...":b.content.resumeName,$("#resume_name .nameShow h1").attr("title",b.content.resumeName).text(c).parent().removeClass("dn"),$("#resume_name form").addClass("dn"),$("#lastChangedTime span").text(b.content.refreshTime),k($("#resume_name"))}else alert(b.msg);$(a).find(":submit").attr("disabled",!1)})}}),$("#basicInfo .c_edit").bind("click",function(){var a=$("#nameVal").val(),b=$("#genderVal").val(),c=$("#topDegreeVal").val(),d=$("#workyearVal").val(),e=$("#currentStateVal").val(),f=$("#emailVal").val(),g=$("#telVal").val();$("#name").val(a),$('#basicInfo .profile_radio li input[value="'+b+'"]').attr("checked",!0).parent("li").addClass("current").siblings("li").removeClass("current"),$("#topDegree").val(c),$("#select_topDegree").val(c).css("color","#333"),$("#workyear").val(d),$("#select_workyear").val(d).css("color","#333"),""!=e&&($("#currentState").val(e),$("#select_currentState").val(e).css("color","#333")),$("#email").val(f),$("#tel").val(g),$("#portraitShow img").attr("src",$("#basicInfo .basicShow img").attr("src")),$("#portraitNo").hide(),$("#portraitShow").show(),$(this).addClass("dn"),$("#basicInfo .basicShow").addClass("dn"),$("#basicInfo .basicEdit").removeClass("dn"),j($("#basicInfo"))}),$("#select_topDegree").bind("click",function(a){a.stopPropagation(),$(this).addClass("select_focus"),$("#select_workyear").removeClass("select_focus"),$("#select_currentState").removeClass("select_focus"),$("#box_topDegree").show(),$("#box_workyear").hide(),$("#box_currentState").hide()}),$("#box_topDegree").on("click","ul li",function(a){a.stopPropagation();var b=$(this).text();$("#select_topDegree").val(b).css("color","#333").removeClass("select_focus"),$("#topDegree").val(b),$("#box_topDegree").hide(),$("#profileForm").validate().element($("#topDegree"))}),$("#select_workyear").bind("click",function(a){a.stopPropagation(),$(this).addClass("select_focus"),$("#select_topDegree").removeClass("select_focus"),$("#select_currentState").removeClass("select_focus"),$("#box_workyear").show(),$("#box_topDegree").hide(),$("#box_currentState").hide()}),$("#box_workyear").on("click","ul li",function(a){a.stopPropagation();var b=$(this).text();$("#select_workyear").val(b).css("color","#333").removeClass("select_focus"),$("#workyear").val(b),$("#box_workyear").hide(),$("#profileForm").validate().element($("#workyear"))}),$("#select_currentState").bind("click",function(a){a.stopPropagation(),$(this).addClass("select_focus"),$("#select_topDegree").removeClass("select_focus"),$("#select_workyear").removeClass("select_focus"),$("#box_workyear").hide(),$("#box_topDegree").hide(),$("#box_currentState").show()}),$("#box_currentState").on("click","ul li",function(a){a.stopPropagation();var b=$(this).text();$("#select_currentState").val(b).css("color","#333").removeClass("select_focus"),$("#currentState").val(b),$("#box_currentState").hide(),$("#profileForm").validate().element($("#currentState"))}),$("#profileForm").validate({rules:{name:{required:!0,specialchar:!0,checkNum:!0,rangelength:[2,20]},gender:{required:!1},topDegree:{required:!0},workyear:{required:!0},currentState:{required:!1},email:{required:!0,email:!0,maxlength:80},tel:{required:!0,isMobile:!0,maxlength:30}},messages:{name:{required:"请输入你的真实姓名",specialchar:"请输入你的真实姓名",checkNum:"请输入你的真实姓名",rangelength:"请输入你的真实姓名"},topDegree:{required:"请选择最高学历"},workyear:{required:"请选择工作年限"},email:{required:"请输入接收面试通知的常用邮箱",email:"请输入有效的常用邮箱，如：vivi@lagou.com",maxlength:"请输入有效的常用邮箱，如：vivi@lagou.com"},tel:{required:"请输入手机号码",isMobile:"请输入有效的手机号码",maxlength:"请输入有效的手机号码"}},errorPlacement:function(a,b){"hidden"==b.attr("type")?a.appendTo($(b).parent()):"radio"==b.attr("type")?a.insertAfter($(b).parents("ul")):a.insertAfter(b)},submitHandler:function(a){var b=$('input[name="name"]',a).val(),c=$('input[name="gender"]:checked',a).val(),d=$('input[name="topDegree"]',a).val(),e=$('input[name="workyear"]',a).val(),f=$('input[name="currentState"]',a).val(),g=$('input[name="email"]',a).val(),h=$('input[name="tel"]',a).val(),i=$("#pageType").val(),j=$("#resumeId").val(),l=$("#resubmitToken").val();$(a).find(":submit").val("保存中...").attr("disabled",!0),$.ajax({url:ctx+"/resume/basic.json",type:"POST",data:{name:b,sex:c,highestEducation:d,workYear:e,status:f,email:g,phone:h,type:i,id:j,resubmitToken:l},dataType:"json"}).done(function(b){var c,d,e;$("#resubmitToken").val(b.resubmitToken),b.success?"/resume/myresume.html"==b.content.url?window.location.href=ctx+b.content.url:(c=b.content.resume,d=c.workYear,"应届毕业生"!=d?(d+="工作经验",$("#workExperience h2 span").text("（投递简历时必填）")):$("#workExperience h2 span").text(""),e=c.name,""!=c.sex&&(e+=" | "+c.sex),""!=c.highestEducation&&(e+=" | "+c.highestEducation),e+=" | "+d+"<br />"+c.phone+" | "+c.email+"<br />"+c.status,$(".collapsible_menu dt").html(c.name+"<i></i>"),$("#basicInfo .basicShow span").html(e).parent().removeClass("dn"),$("#basicInfo .basicEdit").addClass("dn"),$("#basicInfo .c_edit").removeClass("dn"),$("#nameVal").val(c.name),$("#genderVal").val(c.sex),$("#topDegreeVal").val(c.highestEducation),$("#workyearVal").val(c.workYear),$("#currentStateVal").val(c.status),$("#emailVal").val(c.email),$("#telVal").val(c.phone),$("#lastChangedTime span").text(b.content.refreshTime),b.content.isNew&&changeAllIds(b.content.jsonIds),scoreChange(b.content.infoCompleteStatus.score),k($("#basicInfo"))):alert(b.msg),$(a).find(":submit").val("保 存").attr("disabled",!1)})}}),$("#profileForm .btn_profile_cancel").bind("click",function(){$(this).parents(".basicEdit").addClass("dn").siblings(".basicShow").removeClass("dn"),$("#basicInfo .c_edit").removeClass("dn"),k($("#basicInfo"))}),$("#select_expectCity").bind("click",function(a){a.stopPropagation(),$(this).addClass("select_focus"),$("#select_expectSalary").removeClass("select_focus"),$("#box_expectCity").show(),$("#box_expectSalary").hide()}),$("#box_expectCity").on("click","dl dd span",function(a){a.stopPropagation();var b=$(this).text();$("#select_expectCity").val(b).css("color","#333").removeClass("select_focus"),$("#expectCity").val(b),$("#box_expectCity").hide(),$("#expectForm").validate().element($("#expectCity"))}),$("#select_expectSalary").bind("click",function(a){a.stopPropagation(),$(this).addClass("select_focus"),$("#select_expectCity").removeClass("select_focus"),$("#box_expectSalary").show(),$("#box_expectCity").hide()}),$("#box_expectSalary").on("click","ul li",function(a){a.stopPropagation();var b=$(this).text();$("#select_expectSalary").val(b).css("color","#333").removeClass("select_focus"),$("#expectSalary").val(b),$("#box_expectSalary").hide(),$("#profileForm").validate().element($("#expectSalary"))}),b={obj:$("#expectJob"),expectJobVal:$("#expectJobVal").val(),expectCityVal:$("#expectCityVal").val(),typeVal:$("#typeVal").val(),expectPositionVal:$("#expectPositionVal").val(),expectSalaryVal:$("#expectSalaryVal").val(),Add:function(){this.obj.find(".expectAdd").addClass("dn"),this.obj.find(".expectShow").addClass("dn"),this.obj.find(".c_edit").addClass("dn"),this.obj.find(".expectEdit").removeClass("dn"),j(this.obj)},Edit:function(){""==this.expectCityVal?($("#expectCity").val(""),$("#select_expectCity").val("期望城市，如：北京").css("color","#999")):($("#expectCity").val(this.expectCityVal),$("#select_expectCity").val(this.expectCityVal).css("color","#333")),""!=this.typeVal?$('#expectJob .profile_radio li input[value="'+this.typeVal+'"]').attr("checked",!0).parent("li").addClass("current").siblings("li").removeClass("current"):$("#expectJob .profile_radio li input").attr("checked",!1).parent("li").removeClass("current"),$("#expectPosition").val(this.expectPositionVal),""==this.expectSalaryVal?($("#expectSalary").val(""),$("#select_expectSalary").val("期望月薪").css("color","#999")):($("#expectSalary").val(this.expectSalaryVal),$("#select_expectSalary").val(this.expectSalaryVal).css("color","#333")),placeholderFn(),this.obj.find(".expectAdd").addClass("dn"),this.obj.find(".expectShow").addClass("dn"),this.obj.find(".c_edit").addClass("dn"),this.obj.find(".expectEdit").removeClass("dn"),j(this.obj)},Cancel:function(){this.expectCityVal||this.typeVal||this.expectPositionVal||this.expectSalaryVal?this.obj.find(".expectEdit").addClass("dn").siblings(".expectShow").removeClass("dn").siblings(".c_edit").removeClass("dn").siblings(".expectAdd").addClass("dn"):this.obj.find(".expectEdit").addClass("dn").siblings(".expectShow").addClass("dn").siblings(".c_edit").addClass("dn").siblings(".expectAdd").removeClass("dn"),k(this.obj)}},b.obj.find(".expectAdd").bind("click",function(){b.Add()}),b.obj.find(".c_edit").bind("click",function(){b.Edit()}),$("#expectForm .btn_profile_cancel").bind("click",function(){b.Cancel()}),$("#expectPosition").bind("keyup",function(){var a=$.trim($(this).val());""!=a&&suggestPosition(a,"#expectPosition")}),$("#expectForm").validate({rules:{expectCity:{required:!1},type:{required:!1},expectPosition:{required:!1,specialchar:!0,checkNum:!0,minlength:2,maxlength:100},expectSalary:{required:!1}},messages:{expectPosition:{specialchar:"请输入有效的期望职位，如：产品经理",checkNum:"请输入有效的期望职位，如：产品经理",minlength:"请输入有效的期望职位，如：产品经理",maxlength:"请输入有效的期望职位，如：产品经理"}},errorPlacement:function(a,b){"hidden"==b.attr("type")?a.appendTo($(b).parent()):"radio"==b.attr("type")?a.insertAfter($(b).parents("ul")):a.insertAfter(b)},submitHandler:function(a){var c=$('input[name="expectCity"]',a).val(),d=$('input[name="type"]:checked',a).val(),e="期望职位，如：产品经理"!=$('input[name="expectPosition"]',a).val()?$('input[name="expectPosition"]',a).val():"",f=$('input[name="expectSalary"]',a).val(),g=$("#resumeId").val(),h=$("#resubmitToken").val();$(a).find(":submit").val("保存中...").attr("disabled",!0),$.ajax({url:ctx+"/resume/expect.json",type:"POST",data:{city:c,positionType:d,positionName:e,salarys:f,id:g,resubmitToken:h},dataType:"json"}).done(function(g){if($("#resubmitToken").val(g.resubmitToken),g.success){if(c||d||e||f){var h=g.content.expectJob;b.obj.find(".expectShow").children("span").html(h).parent().removeClass("dn"),b.obj.find(".c_edit").removeClass("dn"),b.obj.find(".expectEdit").addClass("dn"),b.obj.find("#expectJobVal").val(g.content.resume.expectJob),b.obj.find("#expectCityVal").val(g.content.resume.city),b.obj.find("#typeVal").val(g.content.resume.positionType),b.obj.find("#expectPositionVal").val(g.content.resume.positionName),b.obj.find("#expectSalaryVal").val(g.content.resume.salarys),b.expectJobVal=g.content.resume.expectJob,b.expectCityVal=g.content.resume.city,b.typeVal=g.content.resume.positionType,b.expectPositionVal=g.content.resume.positionName,b.expectSalaryVal=g.content.resume.salarys,$("#lastChangedTime span").text(g.content.refreshTime),$("#resumeScore .which div").text(g.content.infoCompleteStatus.msg),$("#resumeScore .which span").attr("rel",g.content.infoCompleteStatus.nextStage),scoreChange(g.content.infoCompleteStatus.score),k(b.obj)}else b.obj.find(".expectShow").addClass("dn"),b.obj.find(".expectEdit").addClass("dn"),b.obj.find(".c_edit").addClass("dn"),b.obj.find(".expectAdd").removeClass("dn"),k(b.obj);g.content.isNew&&changeAllIds(g.content.jsonIds)}else alert(g.msg);$(a).find(":submit").val("保 存").attr("disabled",!1)})}}),$(".select_companyYearStart").bind("click",function(a){a.stopPropagation(),openYear("companyYearStart")}),$(".box_companyYearStart").on("click","ul li",function(a){var b,c;a.stopPropagation(),b=$(this).text(),selectYear("companyYearStart",b),c=$(this).parents(".experienceForm"),$(this).parents(".box_companyYearStart").siblings(".companyYearStart").hasClass("error")&&$(this).parents(".experienceForm").validate().element(c.find(".companyYearStart")),c.find(".companyYearEnd").hasClass("error")?$(this).parents(".experienceForm").validate().element(c.find(".companyYearEnd")):c.find(".companyMonthEnd").hasClass("error")&&$(this).parents(".experienceForm").validate().element(c.find(".companyMonthEnd"))}),$(".select_companyMonthStart").bind("click",function(a){a.stopPropagation(),openYear("companyMonthStart")}),$(".box_companyMonthStart").on("click","ul li",function(a){var b,c;a.stopPropagation(),b=$(this).text(),selectYear("companyMonthStart",b),c=$(this).parents(".experienceForm"),$(this).parents(".box_companyMonthStart").siblings(".companyMonthStart").hasClass("error")&&$(this).parents(".experienceForm").validate().element(c.find(".companyMonthStart")),c.find(".companyYearEnd").hasClass("error")?$(this).parents(".experienceForm").validate().element(c.find(".companyYearEnd")):c.find(".companyMonthEnd").hasClass("error")&&$(this).parents(".experienceForm").validate().element(c.find(".companyMonthEnd"))
}),$(".select_companyYearEnd").bind("click",function(a){a.stopPropagation(),openYear("companyYearEnd")}),$(".box_companyYearEnd").on("click","ul li",function(a){var b,c,d;a.stopPropagation(),b=$(this).text(),c=$(this).parents(".experienceForm").find(".companyMonthEnd").val(),selectYear("companyYearEnd",b),d=$(this).parents(".experienceForm"),"至今"==$.trim(b)?(d.find(".companyMonthEnd").val("至今"),d.find(".select_companyMonthEnd").css("color","#333").val("至今"),d.find(".select_companyMonthEnd").unbind("click")):("至今"==$.trim(c)&&(d.find(".companyMonthEnd").val(""),d.find(".select_companyMonthEnd").css("color","#999").val("结束时间")),d.find(".select_companyMonthEnd").bind("click",function(a){a.stopPropagation(),openYear("companyMonthEnd")})),$(this).parents(".box_companyYearEnd").siblings(".companyYearEnd").hasClass("error")&&$(this).parents(".experienceForm").validate().element(d.find(".companyYearEnd")),d.find(".companyYearStart").hasClass("error")?$(this).parents(".experienceForm").validate().element(d.find(".companyYearStart")):d.find(".companyMonthStart").hasClass("error")&&$(this).parents(".experienceForm").validate().element(d.find(".companyMonthStart"))}),$(".select_companyMonthEnd").bind("click",function(a){a.stopPropagation(),openYear("companyMonthEnd")}),$(".box_companyMonthEnd").on("click","ul li",function(a){var b,c;a.stopPropagation(),b=$(this).text(),selectYear("companyMonthEnd",b),c=$(this).parents(".experienceForm"),$(this).parents(".box_companyMonthEnd").siblings(".companyMonthEnd").hasClass("error")&&$(this).parents(".experienceForm").validate().element(c.find(".companyMonthEnd")),c.find(".companyYearStart").hasClass("error")?$(this).parents(".experienceForm").validate().element(c.find(".companyYearStart")):c.find(".companyMonthStart").hasClass("error")&&$(this).parents(".experienceForm").validate().element(c.find(".companyMonthStart"))}),c={obj:$("#workExperience"),companyNameVal:"",positionNameVal:"",companyYearStartVal:"",companyMonthStartVal:"",companyYearEndVal:"",companyMonthEndVal:"",Add:function(){this.obj.children(".experienceEdit").find(".companyName").val(""),this.obj.children(".experienceEdit").find(".positionName").val(""),this.obj.children(".experienceEdit").find(".companyYearStart").val(""),this.obj.children(".experienceEdit").find(".select_companyYearStart").css("color","#999").val("开始年份"),this.obj.children(".experienceEdit").find(".companyMonthStart").val(""),this.obj.children(".experienceEdit").find(".select_companyMonthStart").css("color","#999").val("开始月份"),this.obj.children(".experienceEdit").find(".companyYearEnd").val(""),this.obj.children(".experienceEdit").find(".select_companyYearEnd").css("color","#999").val("结束年份"),this.obj.children(".experienceEdit").find(".companyMonthEnd").val(""),this.obj.children(".experienceEdit").find(".select_companyMonthEnd").css("color","#999").val("结束月份"),placeholderFn(),this.obj.children(".experienceAdd").addClass("dn"),this.obj.children(".experienceShow").addClass("dn"),this.obj.children(".experienceEdit").removeClass("dn"),j(this.obj)},AddMore:function(){this.obj.children(".experienceShow").find(".companyName").val(""),this.obj.children(".experienceShow").find(".positionName").val(""),this.obj.children(".experienceShow").find(".companyYearStart").val(""),this.obj.children(".experienceShow").find(".select_companyYearStart").css("color","#999").val("开始年份"),this.obj.children(".experienceShow").find(".companyMonthStart").val(""),this.obj.children(".experienceShow").find(".select_companyMonthStart").css("color","#999").val("开始月份"),this.obj.children(".experienceShow").find(".companyYearEnd").val(""),this.obj.children(".experienceShow").find(".select_companyYearEnd").css("color","#999").val("结束年份"),this.obj.children(".experienceShow").find(".companyMonthEnd").val(""),this.obj.children(".experienceShow").find(".select_companyMonthEnd").css("color","#999").val("结束月份"),this.obj.children(".experienceShow").find(".expId").val(""),placeholderFn(),this.obj.children(".experienceShow").children(".experienceForm").show(),j(this.obj)},Edit:function(a){var h,i,b=a.parent("li").attr("data-id"),c=a.siblings("span").attr("data-startYear"),d=a.siblings("span").attr("data-endYear"),e=a.siblings("span").attr("data-startMonth"),f=a.siblings("span").attr("data-endMonth");a.parent("li").find("img").attr("src"),h=a.parent("li").find("h3").text(),i=a.parent("li").find("h4").text(),this.obj.children(".experienceShow").find(".companyName").val(i),this.obj.children(".experienceShow").find(".positionName").val(h),this.obj.children(".experienceShow").find(".companyYearStart").val(c),this.obj.children(".experienceShow").find(".select_companyYearStart").css("color","#333").val(c),this.obj.children(".experienceShow").find(".companyMonthStart").val(e),this.obj.children(".experienceShow").find(".select_companyMonthStart").css("color","#333").val(e),this.obj.children(".experienceShow").find(".companyYearEnd").val(d),this.obj.children(".experienceShow").find(".select_companyYearEnd").css("color","#333").val(d),this.obj.children(".experienceShow").find(".companyMonthEnd").val(f),this.obj.children(".experienceShow").find(".select_companyMonthEnd").css("color","#333").val(f),this.obj.children(".experienceShow").find(".expId").val(b),this.obj.children(".experienceShow").children(".experienceForm").show(),"至今"==$.trim(f)&&this.obj.children(".experienceShow").find(".select_companyMonthEnd").unbind("click"),this.companyNameVal=i,this.positionNameVal=h,this.companyYearStartVal=c,this.companyMonthStartVal=e,this.companyYearEndVal=d,this.companyMonthEndVal=f,this.obj.children(".c_add").addClass("dn"),j(this.obj)},Del:function(a){var b=a.parent("li").attr("data-id");$.ajax({url:ctx+"/workExperience/delExp.json",type:"POST",data:{id:b}}).done(function(b){b.success?(a.parent("li").remove(),""==b.content.workExperiences||null==b.content.workExperiences?(c.obj.children(".experienceShow").addClass("dn"),c.obj.children(".experienceEdit").addClass("dn"),c.obj.children(".experienceAdd").removeClass("dn"),c.obj.children(".c_add").addClass("dn")):c.obj.children(".experienceShow").children(".experienceForm").hide(),$("#lastChangedTime span").text(b.content.refreshTime),$("#resumeScore .which div").text(b.content.infoCompleteStatus.msg),$("#resumeScore .which span").attr("rel",b.content.infoCompleteStatus.nextStage),scoreChange(b.content.infoCompleteStatus.score),k(c.obj),b.content.isNew&&changeAllIds(b.content.jsonIds)):alert(b.msg)})},AddCancel:function(){this.obj.find(".experienceAdd").removeClass("dn"),this.obj.find(".experienceShow").addClass("dn"),this.obj.find(".experienceEdit").addClass("dn"),k(this.obj)},AddMoreCancel:function(){this.obj.children(".experienceShow").children(".experienceForm").hide(),k(this.obj)}},c.obj.find(".experienceAdd").bind("click",function(){c.Add()}),c.obj.find(".c_add").bind("click",function(){c.AddMore(),$(this).addClass("dn")}),c.obj.on("click",".sm_edit",function(){c.Edit($(this))}),c.obj.on("click",".sm_del",function(){confirm("确认要删除吗？")&&c.Del($(this))}),c.obj.children(".experienceShow").on({mouseenter:function(){$(this).children(".wlist").find(".sm_del,.sm_edit").removeClass("dn")},mouseleave:function(){$(this).children(".wlist").find(".sm_del,.sm_edit").addClass("dn")}}),c.obj.children(".experienceEdit").find(".btn_profile_cancel").bind("click",function(){c.AddCancel()}),c.obj.children(".experienceShow").find(".btn_profile_cancel").bind("click",function(){c.AddMoreCancel(),c.obj.find(".c_add").removeClass("dn")}),c.obj.delegate(".companyName","keyup",function(){var a=$.trim($(this).val());""!=a&&suggestCompany(a,".companyName")}),c.obj.delegate(".positionName","keyup",function(){var a=$.trim($(this).val());""!=a&&suggestPosition(a,".positionName")}),$(".experienceForm").each(function(){$(this).validate({groups:{companyStart:"companyYearStart companyMonthStart",companyEnd:"companyYearEnd companyMonthEnd"},rules:{companyName:{required:!0,maxlenStr:100},positionName:{required:!0,checkNum:!0,maxlenStr:100},companyYearStart:{required:!0,checkWorkYear:!0},companyMonthStart:{required:!0,checkWorkYear:!0},companyYearEnd:{required:!0,checkWorkYear:!0},companyMonthEnd:{required:function(){return"至今"==$(".companyYearEnd").val()?!1:!0},checkWorkYear:!0}},messages:{companyName:{required:"请输入有效的公司名称，如：拉勾网",maxlenStr:"请输入有效的公司名称，如：拉勾网"},positionName:{required:"请输入有效的职位名称，如：产品经理",checkNum:"请输入有效的职位名称，如：产品经理",maxlenStr:"请输入有效的职位名称，如：产品经理"},companyYearStart:{required:"请选择开始时间",checkWorkYear:"开始时间需早于结束时间"},companyMonthStart:{required:"请选择开始时间",checkWorkYear:"开始时间需早于结束时间"},companyYearEnd:{required:"请选择结束时间",checkWorkYear:"结束时间需晚于开始时间"},companyMonthEnd:{required:"请选择结束时间",checkWorkYear:"结束时间需晚于开始时间"}},errorPlacement:function(a,b){"companyYearStart"==b.attr("name")||"companyMonthStart"==b.attr("name")||"companyYearEnd"==b.attr("name")||"companyMonthEnd"==b.attr("name")?a.appendTo($(b).parent().parent()):a.insertAfter(b)},submitHandler:function(a){var b=$('input[name="companyName"]',a).val(),d=$('input[name="positionName"]',a).val(),e=$('input[name="companyYearStart"]',a).val(),f=$('input[name="companyMonthStart"]',a).val(),g=$('input[name="companyYearEnd"]',a).val(),h=$('input[name="companyMonthEnd"]',a).val(),i=$(".expId",a).val(),j=$("#resumeId").val(),l=$("#resubmitToken").val();$(a).find(":submit").val("保存中...").attr("disabled",!0),$.ajax({url:ctx+"/workExperience/save.json",type:"POST",data:{companyName:b,positionName:d,startYear:e,startMonth:f,endYear:g,endMonth:h,expid:i,id:j,resubmitToken:l},dataType:"json"}).done(function(b){var d,e,f;if($("#resubmitToken").val(b.resubmitToken),b.success){for(d=b.content.workExperiences,e="",f=0;f<d.length;f++)e+=0==f%2?'<li data-id="'+d[f].id+'" class="clear">':'<li data-id="'+d[f].id+'">',e+='<i class="sm_del dn"></i><i class="sm_edit dn"></i><span class="c9" data-startYear="'+d[f].startYear+'" data-endYear="'+d[f].endYear+'" data-startMonth = "'+d[f].startMonth+'" data-endMonth = "'+d[f].endMonth+'">'+d[f].startDate+"-"+d[f].endDate+"</span>"+"<div>"+'<img src="'+ctx+"/"+d[f].companyLogo+'" width="56" height="56" alt="'+d[f].companyName+'" />'+"<h3>"+d[f].positionName+"</h3>"+"<h4>"+d[f].companyName+"</h4>"+"</div>"+"</li>";c.obj.children(".c_add").removeClass("dn"),c.obj.children(".experienceShow").children(".experienceForm").hide(),c.obj.children(".experienceShow").children(".wlist").html(e).parent().removeClass("dn"),c.obj.children(".experienceEdit").addClass("dn"),$("#lastChangedTime span").text(b.content.refreshTime),$("#resumeScore .which div").text(b.content.infoCompleteStatus.msg),$("#resumeScore .which span").attr("rel",b.content.infoCompleteStatus.nextStage),scoreChange(b.content.infoCompleteStatus.score),k(c.obj),b.content.isNew&&changeAllIds(b.content.jsonIds)}else alert(b.msg);$(a).find(":submit").val("保 存").attr("disabled",!1)})}})}),$("#projectExperience").on("click",".select_projectYearStart",function(a){a.stopPropagation(),$(".profile_select_normal").removeClass("select_focus"),$(".boxUpDown").hide(),$(this).addClass("select_focus"),$(this).siblings(".box_projectYearStart").show()}),$("#projectExperience").on("click",".box_projectYearStart li",function(a){var b,c;a.stopPropagation(),b=$(this).text(),$(this).parents(".box_projectYearStart").siblings(".select_projectYearStart").val(b).css("color","#333").removeClass("select_focus"),$(this).parents(".box_projectYearStart").siblings(".projectYearStart").val(b),$(this).parents(".box_projectYearStart").hide(),c=$(this).parents(".projectForm"),$(this).parents(".box_projectYearStart").siblings(".projectYearStart").hasClass("error")&&$(this).parents(".projectForm").validate().element(c.find(".projectYearStart")),c.find(".projectYearEnd").hasClass("error")?$(this).parents(".projectForm").validate().element(c.find(".projectYearEnd")):c.find(".projectMonthEnd").hasClass("error")&&$(this).parents(".projectForm").validate().element(c.find(".projectMonthEnd"))}),$("#projectExperience").on("click",".select_projectMonthStart",function(a){a.stopPropagation(),$(".profile_select_normal").removeClass("select_focus"),$(".boxUpDown").hide(),$(this).addClass("select_focus"),$(this).siblings(".box_projectMonthStart").show()}),$("#projectExperience").on("click",".box_projectMonthStart li",function(a){var b,c;a.stopPropagation(),b=$(this).text(),$(this).parents(".box_projectMonthStart").siblings(".select_projectMonthStart").val(b).css("color","#333").removeClass("select_focus"),$(this).parents(".box_projectMonthStart").siblings(".projectMonthStart").val(b),$(this).parents(".box_projectMonthStart").hide(),c=$(this).parents(".projectForm"),$(this).parents(".box_projectMonthStart").siblings(".projectMonthStart").hasClass("error")&&$(this).parents(".projectForm").validate().element(c.find(".projectMonthStart")),c.find(".projectYearEnd").hasClass("error")?$(this).parents(".projectForm").validate().element(c.find(".projectYearEnd")):c.find(".projectMonthEnd").hasClass("error")&&$(this).parents(".projectForm").validate().element(c.find(".projectMonthEnd"))}),$("#projectExperience").on("click",".select_projectYearEnd",function(a){a.stopPropagation(),$(".profile_select_normal").removeClass("select_focus"),$(".boxUpDown").hide(),$(this).addClass("select_focus"),$(this).siblings(".box_projectYearEnd").show()}),$("#projectExperience").on("click",".box_projectYearEnd li",function(a){var b,c,d;a.stopPropagation(),b=$(this).text(),c=$(this).parents(".projectForm").find(".projectMonthEnd").val(),$(this).parents(".box_projectYearEnd").siblings(".select_projectYearEnd").val(b).css("color","#333").removeClass("select_focus"),$(this).parents(".box_projectYearEnd").siblings(".projectYearEnd").val(b),$(this).parents(".box_projectYearEnd").hide(),d=$(this).parents(".projectForm"),"至今"==$.trim(b)?(d.find(".projectMonthEnd").val("至今"),d.find(".select_projectMonthEnd").css("color","#333").val("至今"),$("#projectExperience").off("click",".select_projectMonthEnd")):("至今"==$.trim(c)&&(d.find(".projectMonthEnd").val(""),d.find(".select_projectMonthEnd").css("color","#999").val("结束时间")),$("#projectExperience").on("click",".select_projectMonthEnd",function(a){a.stopPropagation(),$(".profile_select_normal").removeClass("select_focus"),$(".boxUpDown").hide(),$(this).addClass("select_focus"),$(this).siblings(".box_projectMonthEnd").show()})),$(this).parents(".box_projectYearEnd").siblings(".projectYearEnd").hasClass("error")&&$(this).parents(".projectForm").validate().element(d.find(".projectYearEnd")),d.find(".projectYearStart").hasClass("error")?$(this).parents(".projectForm").validate().element(d.find(".projectYearStart")):d.find(".projectMonthStart").hasClass("error")&&$(this).parents(".projectForm").validate().element(d.find(".projectMonthStart"))}),$("#projectExperience").on("click",".select_projectMonthEnd",function(a){a.stopPropagation(),$(".profile_select_normal").removeClass("select_focus"),$(".boxUpDown").hide(),$(this).addClass("select_focus"),$(this).siblings(".box_projectMonthEnd").show()}),$("#projectExperience").on("click",".box_projectMonthEnd li",function(a){var b,c;a.stopPropagation(),b=$(this).text(),$(this).parents(".box_projectMonthEnd").siblings(".select_projectMonthEnd").val(b).css("color","#333").removeClass("select_focus"),$(this).parents(".box_projectMonthEnd").siblings(".projectMonthEnd").val(b),$(this).parents(".box_projectMonthEnd").hide(),c=$(this).parents(".projectForm"),$(this).parents(".box_projectMonthEnd").siblings(".projectMonthEnd").hasClass("error")&&$(this).parents(".projectForm").validate().element(c.find(".projectMonthEnd")),c.find(".projectYearStart").hasClass("error")?$(this).parents(".projectForm").validate().element(c.find(".projectYearStart")):c.find(".projectMonthStart").hasClass("error")&&$(this).parents(".projectForm").validate().element(c.find(".projectMonthStart"))}),d={obj:$("#projectExperience"),resetForm:function(){this.obj.children(".projectEdit").find(".projectName").val(""),this.obj.children(".projectEdit").find(".thePost").val(""),this.obj.children(".projectEdit").find(".projectYearStart").val(""),this.obj.children(".projectEdit").find(".select_projectYearStart").css("color","#999").val("开始年份"),this.obj.children(".projectEdit").find(".projectMonthStart").val(""),this.obj.children(".projectEdit").find(".select_projectMonthStart").css("color","#999").val("开始月份"),this.obj.children(".projectEdit").find(".projectYearEnd").val(""),this.obj.children(".projectEdit").find(".select_projectYearEnd").css("color","#999").val("结束年份"),this.obj.children(".projectEdit").find(".projectMonthEnd").val(""),this.obj.children(".projectEdit").find(".select_projectMonthEnd").css("color","#999").val("结束月份"),this.obj.children(".projectEdit").find(".projectDescription").val(""),this.obj.children(".projectEdit").find(".word_count").children("span").text(500),this.obj.children(".projectEdit").find(".projectId").val("")},Add:function(){this.resetForm(),placeholderFn(),this.obj.children(".projectAdd").addClass("dn"),this.obj.children(".projectShow").addClass("dn"),this.obj.children(".projectEdit").removeClass("dn"),j(this.obj)},AddMore:function(){this.resetForm(),placeholderFn(),this.obj.children(".projectShow").prepend(this.obj.children(".projectEdit").children("form").clone()),this.obj.children(".projectShow").children("form").css("borderBottom","1px solid #e5e5e5").show(),this.obj.children(".projectEdit").addClass("dn"),e(),j(this.obj)},Edit:function(a){var m,b=a.parents("li"),c=b.attr("data-id"),d=b.find("div.f16").attr("data-proName"),f=b.find("div.f16").attr("data-posName"),g=b.find("div.f16").attr("data-startY"),h=b.find("div.f16").attr("data-startM"),i=b.find("div.f16").attr("data-endY"),k=b.find("div.f16").attr("data-endM"),l=b.find(".dl1").html();l&&(l=$.trim(l.replace(/<br>/gi,""))),this.resetForm(),m=this.obj.children(".projectEdit").children("form").clone(),m.find(".projectName").val(d),m.find(".thePost").val(f),""!=g&&(m.find(".projectYearStart").val(g),m.find(".select_projectYearStart").css("color","#333").val(g)),""!=h&&(m.find(".projectMonthStart").val(h),m.find(".select_projectMonthStart").css("color","#333").val(h)),""!=i&&(m.find(".projectYearEnd").val(i),m.find(".select_projectYearEnd").css("color","#333").val(i)),""!=k&&(m.find(".projectMonthEnd").val(k),m.find(".select_projectMonthEnd").css("color","#333").val(k)),"至今"==$.trim(k)&&m.find(".select_projectMonthEnd").unbind("click"),m.find(".projectDescription").val(l),m.find(".word_count").children("span").text(500-m.find(".projectDescription").val().length),m.find(".projectId").val(c),a.parents("li").prepend(m),placeholderFn(),a.parents("li").children(".projectList").addClass("dn"),e(),j(this.obj)},Del:function(a){var b=a.parents("li").attr("data-id");$.ajax({url:ctx+"/projectExperience/delProject.json",type:"POST",data:{id:b}}).done(function(b){b.success?(a.parents("li").remove(),$("ul.plist li:last-child").addClass("noborder"),(""==b.content.projectExperiences||null==b.content.projectExperiences)&&(d.obj.children(".projectShow").addClass("dn"),d.obj.children(".projectEdit").addClass("dn"),d.obj.children(".projectAdd").removeClass("dn"),d.obj.children(".c_add").addClass("dn")),$("#lastChangedTime span").text(b.content.refreshTime),$("#resumeScore .which div").text(b.content.infoCompleteStatus.msg),$("#resumeScore .which span").attr("rel",b.content.infoCompleteStatus.nextStage),scoreChange(b.content.infoCompleteStatus.score),k(d.obj),b.content.isNew&&changeAllIds(b.content.jsonIds)):alert(b.msg)})},AddCancel:function(){this.obj.find(".projectAdd").removeClass("dn"),this.obj.find(".projectShow").addClass("dn"),this.obj.find(".projectEdit").addClass("dn"),k(this.obj)},AddMoreCancel:function(a){a.parents(".projectForm").siblings(".projectList").removeClass("dn"),a.parents(".projectForm").remove(),k(this.obj)}},d.obj.find(".plist li:last-child").addClass("noborder"),d.obj.find(".projectAdd").bind("click",function(){d.Add()}),d.obj.find(".c_add").bind("click",function(){d.AddMore(),$(this).addClass("dn")}),d.obj.on("click",".sm_edit",function(){d.Edit($(this))}),d.obj.on("click",".sm_del",function(){confirm("确认要删除吗？")&&d.Del($(this))}),d.obj.children(".projectShow").on({mouseenter:function(){$(this).children(".plist").find(".sm_del,.sm_edit").removeClass("dn")},mouseleave:function(){$(this).children(".plist").find(".sm_del,.sm_edit").addClass("dn")}}),d.obj.on("keyup",".s_textarea",function(){var a=$(this);$.trim(a.val()).length>500?a.val($.trim(a.val()).substring(0,500)):a.next(".word_count").children("span").text(500-$.trim(a.val()).length)}),d.obj.children(".projectEdit").find(".btn_profile_cancel").bind("click",function(){d.AddCancel()}),d.obj.children(".projectShow").on("click",".btn_profile_cancel",function(){d.AddMoreCancel($(this)),d.obj.find(".c_add").removeClass("dn")}),e(),$(".select_schoolYearStart").bind("click",function(a){a.stopPropagation(),openYear("schoolYearStart")}),$(".box_schoolYearStart").on("click","ul li",function(a){a.stopPropagation();var b=$(this).text();selectYear("schoolYearStart",b),$(this).parents(".educationalForm").validate().element($(".schoolYearStart"))}),$(".select_schoolYearEnd").bind("click",function(a){a.stopPropagation(),openYear("schoolYearEnd")}),$(".box_schoolYearEnd").on("click","ul li",function(a){a.stopPropagation();var b=$(this).text();selectYear("schoolYearEnd",b),$(this).parents(".educationalForm").validate().element($(".schoolYearEnd"))}),$(".select_degree").bind("click",function(a){a.stopPropagation(),$(this).addClass("select_focus"),$(".select_schoolYearStart").removeClass("select_focus"),$(".select_schoolYearEnd").removeClass("select_focus"),$(".box_schoolYearStart").hide(),$(".box_schoolYearEnd").hide(),$(".box_degree").show()}),$(".box_degree").on("click","ul li",function(a){a.stopPropagation();var b=$(this).text();$(".select_degree").val(b).css("color","#333").removeClass("select_focus"),$(".degree").val(b),$(".box_degree").hide(),$(this).parents(".educationalForm").validate().element($(".degree"))}),f={obj:$("#educationalBackground"),schoolNameVal:"",degreeVal:"",professionalNameVal:"",schoolYearStartVal:"",schoolYearEndVal:"",Add:function(){this.obj.children(".educationalEdit").find(".schoolName").val(""),this.obj.children(".educationalEdit").find(".degree").val(""),this.obj.children(".educationalEdit").find(".select_degree").css("color","#999").val("学历"),this.obj.children(".educationalEdit").find(".professionalName").val(""),this.obj.children(".educationalEdit").find(".schoolYearStart").val(""),this.obj.children(".educationalEdit").find(".select_schoolYearStart").css("color","#999").val("开始年份"),this.obj.children(".educationalEdit").find(".schoolYearEnd").val(""),this.obj.children(".educationalEdit").find(".select_schoolYearEnd").css("color","#999").val("结束年份"),placeholderFn(),this.obj.children(".educationalAdd").addClass("dn"),this.obj.children(".educationalShow").addClass("dn"),this.obj.children(".educationalEdit").removeClass("dn"),j(this.obj)},AddMore:function(){this.obj.children(".educationalShow").find(".schoolName").val(""),this.obj.children(".educationalShow").find(".degree").val(""),this.obj.children(".educationalShow").find(".select_degree").css("color","#999").val("学历"),this.obj.children(".educationalShow").find(".professionalName").val(""),this.obj.children(".educationalShow").find(".schoolYearStart").val(""),this.obj.children(".educationalShow").find(".select_schoolYearStart").css("color","#999").val("开始年份"),this.obj.children(".educationalShow").find(".schoolYearEnd").val(""),this.obj.children(".educationalShow").find(".select_schoolYearEnd").css("color","#999").val("结束年份"),this.obj.children(".educationalShow").find(".eduId").val(""),placeholderFn(),this.obj.children(".educationalShow").children(".educationalForm").show(),j(this.obj)},Edit:function(a){var b=a.parent("li").attr("data-id"),c=a.siblings("span").attr("data-startY"),d=a.siblings("span").attr("data-endY"),e=a.parent("li").find("h4").attr("data-degree"),f=a.parent("li").find("h4").attr("data-proName"),g=a.parent("li").find("h3").attr("data-schName");this.obj.children(".educationalShow").find(".schoolName").val(g),this.obj.children(".educationalShow").find(".degree").val(e),this.obj.children(".educationalShow").find(".select_degree").css("color","#333").val(e),this.obj.children(".educationalShow").find(".professionalName").val(f),this.obj.children(".educationalShow").find(".schoolYearStart").val(c),this.obj.children(".educationalShow").find(".select_schoolYearStart").css("color","#333").val(c),this.obj.children(".educationalShow").find(".schoolYearEnd").val(d),this.obj.children(".educationalShow").find(".select_schoolYearEnd").css("color","#333").val(d),this.obj.children(".educationalShow").find(".eduId").val(b),$(".educationalForm").validate().element($(".schoolYearStart")),this.obj.children(".educationalShow").children(".educationalForm").show(),this.schoolNameVal=g,this.degreeVal=e,this.professionalNameVal=f,this.schoolYearStartVal=c,this.schoolYearEndVal=d,this.obj.children(".c_add").addClass("dn"),j(this.obj)},Del:function(a){var b=a.parent("li").attr("data-id");$.ajax({url:ctx+"/educationExperience/delEdu.json",type:"POST",data:{id:b}}).done(function(b){b.success?(a.parent("li").remove(),""==b.content.educationExperiences||null==b.content.educationExperiences?(f.obj.children(".educationalShow").addClass("dn"),f.obj.children(".educationalEdit").addClass("dn"),f.obj.children(".educationalAdd").removeClass("dn"),f.obj.children(".c_add").addClass("dn")):f.obj.children(".educationalShow").children(".educationalForm").hide(),$("#lastChangedTime span").text(b.content.refreshTime),$("#resumeScore .which div").text(b.content.infoCompleteStatus.msg),$("#resumeScore .which span").attr("rel",b.content.infoCompleteStatus.nextStage),scoreChange(b.content.infoCompleteStatus.score),k(f.obj),b.content.isNew&&changeAllIds(b.content.jsonIds)):alert(b.msg)})},AddCancel:function(){this.obj.find(".educationalAdd").removeClass("dn"),this.obj.find(".educationalShow").addClass("dn"),this.obj.find(".educationalEdit").addClass("dn"),k(this.obj)},AddMoreCancel:function(){this.obj.children(".educationalShow").children(".educationalForm").hide(),k(this.obj)}},f.obj.find(".educationalAdd").bind("click",function(){f.Add()}),f.obj.find(".c_add").bind("click",function(){f.AddMore(),$(this).addClass("dn")}),f.obj.on("click",".sm_edit",function(){f.Edit($(this))}),f.obj.on("click",".sm_del",function(){confirm("确认要删除吗？")&&f.Del($(this))}),f.obj.children(".educationalShow").on({mouseenter:function(){$(this).children(".elist").find(".sm_del,.sm_edit").removeClass("dn")},mouseleave:function(){$(this).children(".elist").find(".sm_del,.sm_edit").addClass("dn")}}),f.obj.children(".educationalEdit").find(".btn_profile_cancel").bind("click",function(){f.AddCancel()}),f.obj.children(".educationalShow").find(".btn_profile_cancel").bind("click",function(){f.AddMoreCancel(),f.obj.find(".c_add").removeClass("dn")}),$(".educationalForm").each(function(){$(this).validate({groups:{schoolYear:"schoolYearStart schoolYearEnd"},rules:{schoolName:{required:!0,checkNum:!0,maxlenStr:100},degree:{required:!0},professionalName:{required:!0,checkNum:!0,maxlenStr:100},schoolYearStart:{required:!0,checkSchoolYear:!0},schoolYearEnd:{required:!0,checkSchoolYear:!0}},messages:{schoolName:{required:"请输入学校名称",checkNum:"请输入有效的学校名称",maxlenStr:"请输入有效的学校名称"},degree:{required:"请选择学历"},professionalName:{required:"请输入专业名称，如：软件工程",checkNum:"请输入有效的专业名称，如：软件工程",maxlenStr:"请输入有效的专业名称，如：软件工程"},schoolYearStart:{required:"请选择开始年份",checkSchoolYear:"开始年份需小于结束年份"},schoolYearEnd:{required:"请选择结束年份",checkSchoolYear:"结束年份不能早于开始年份"}},errorPlacement:function(a,b){"hidden"==b.attr("type")?"schoolYearStart"==b.attr("name")||"schoolYearEnd"==b.attr("name")?a.appendTo($(b).parent().parent()):a.appendTo($(b).parent()):a.insertAfter(b)},submitHandler:function(a){var b=$('input[name="schoolName"]',a).val(),c=$('input[name="degree"]',a).val(),d=$('input[name="professionalName"]',a).val(),e=$('input[name="schoolYearStart"]',a).val(),g=$('input[name="schoolYearEnd"]',a).val(),h=$(".eduId",a).val(),i=$("#resumeId").val(),j=$("#resubmitToken").val();$(a).find(":submit").val("保存中...").attr("disabled",!0),$.ajax({url:ctx+"/educationExperience/save.json",type:"POST",data:{schoolName:b,education:c,professional:d,startYear:e,endYear:g,eduid:h,id:i,resubmitToken:j},dataType:"json"}).done(function(b){var c,d,e;if($("#resubmitToken").val(b.resubmitToken),b.success){for(c=b.content.educationExperiences,d="",e=0;e<c.length;e++)d+=0==e%2?'<li data-id="'+c[e].id+'" class="clear">':'<li data-id="'+c[e].id+'">',d+='<i class="sm_del dn"></i><i class="sm_edit dn"></i><span class="c9" data-startY="'+c[e].startDate+'" data-endY="'+c[e].endDate+'">'+c[e].startDate+"-"+c[e].endDate+"</span>"+"<div>"+'<h3 data-schName="'+c[e].schoolName+'">'+c[e].schoolName+"</h3>"+'<h4 data-proName="'+c[e].professional+'" data-degree="'+c[e].education+'">'+c[e].education+"，"+c[e].professional+"</h4>"+"</div>"+"</li>";f.obj.children(".c_add").removeClass("dn"),f.obj.children(".educationalShow").children(".educationalForm").hide(),f.obj.children(".educationalShow").children(".elist").html(d).parent().removeClass("dn"),f.obj.children(".educationalEdit").addClass("dn"),$("#lastChangedTime span").text(b.content.refreshTime),$("#resumeScore .which div").text(b.content.infoCompleteStatus.msg),$("#resumeScore .which span").attr("rel",b.content.infoCompleteStatus.nextStage),scoreChange(b.content.infoCompleteStatus.score),k(f.obj),b.content.isNew&&changeAllIds(b.content.jsonIds)}else alert(b.msg);$(a).find(":submit").val("保 存").attr("disabled",!1)})}})}),g={obj:$("#selfDescription"),text:$("#selfDescription .selfDescription").val(),Add:function(){this.obj.children(".descriptionEdit").find(".selfDescription").val(""),this.obj.children(".descriptionAdd").addClass("dn"),this.obj.children(".descriptionShow").addClass("dn"),this.obj.children(".descriptionEdit").removeClass("dn"),j(this.obj)},Edit:function(){var b=this.obj.children(".descriptionShow").html();b=$.trim(b.replace(/<br>/gi,"")),this.text=b,this.obj.children(".descriptionEdit").find(".selfDescription").val(b),this.obj.children(".descriptionEdit").find(".word_count").children("span").text(500-b.length),this.obj.children(".descriptionShow").addClass("dn"),this.obj.children(".descriptionEdit").removeClass("dn"),this.obj.children(".c_edit").addClass("dn"),j(this.obj)},Cancel:function(){this.text?(this.obj.children(".descriptionAdd").addClass("dn"),this.obj.children(".descriptionShow").removeClass("dn"),this.obj.children(".descriptionEdit").addClass("dn"),this.obj.children(".c_edit").removeClass("dn")):(this.obj.children(".descriptionAdd").removeClass("dn"),this.obj.children(".descriptionShow").addClass("dn"),this.obj.children(".descriptionEdit").addClass("dn")),k(this.obj)}},g.obj.children(".descriptionAdd").bind("click",function(){g.Add()}),g.obj.children(".c_edit").bind("click",function(){g.Edit()}),g.obj.children(".descriptionEdit").find(".btn_profile_cancel").bind("click",function(){g.Cancel()}),g.obj.on("keyup",".s_textarea",function(){textCounter("selfDescription","",500)}),$(".descriptionForm").validate({rules:{selfDescription:{required:!1}},submitHandler:function(a){var b=$('textarea[name="selfDescription"]',a).val(),c=$("#resumeId").val(),d=$("#resubmitToken").val();$(a).find(":submit").val("保存中...").attr("disabled",!0),$.ajax({url:ctx+"/resume/intro.json",type:"POST",data:{myRemark:b,id:c,resubmitToken:d},dataType:"json"}).done(function(b){var c,d;$("#resubmitToken").val(b.resubmitToken),b.success?(c=b.content.resume,d="",c.myRemark?(d=c.myRemark,g.text=c.myRemark,g.obj.children(".c_edit").removeClass("dn"),g.obj.children(".descriptionShow").html(d).removeClass("dn"),g.obj.children(".descriptionEdit").addClass("dn"),$("#lastChangedTime span").text(b.content.refreshTime),$("#resumeScore .which div").text(b.content.infoCompleteStatus.msg),$("#resumeScore .which span").attr("rel",b.content.infoCompleteStatus.nextStage),scoreChange(b.content.infoCompleteStatus.score),k(g.obj)):(g.text="",g.obj.children(".c_edit").addClass("dn"),g.obj.children(".descriptionShow").addClass("dn"),g.obj.children(".descriptionEdit").addClass("dn"),g.obj.children(".descriptionAdd").removeClass("dn"),$("#lastChangedTime span").text(b.content.refreshTime),$("#resumeScore .which div").text(b.content.infoCompleteStatus.msg),$("#resumeScore .which span").attr("rel",b.content.infoCompleteStatus.nextStage),scoreChange(b.content.infoCompleteStatus.score),k(g.obj)),b.content.isNew&&changeAllIds(b.content.jsonIds)):alert(b.msg),$(a).find(":submit").val("保 存").attr("disabled",!1)
})}}),h={obj:$("#worksShow"),resetForm:function(){this.obj.children(".workEdit").find(".workLink").val(""),this.obj.children(".workEdit").find(".workDescription").val(""),this.obj.children(".workEdit").find(".showId").val(""),this.obj.children(".workEdit").find(".word_count").children("span").text(100)},Add:function(){this.resetForm(),placeholderFn(),this.obj.children(".workAdd").addClass("dn"),this.obj.children(".workShow").addClass("dn"),h.obj.children(".workShow").find("form").addClass("dn"),this.obj.children(".workEdit").removeClass("dn"),j(this.obj)},AddMore:function(){this.resetForm(),this.obj.children(".workShow").prepend(this.obj.children(".workEdit").children("form").clone()),this.obj.children(".workEdit").addClass("dn"),placeholderFn(),i(),j(this.obj)},Edit:function(a){var f,b=a.parents("li"),c=b.attr("data-id"),d=b.find("div.f16 a").text(),e=b.find("p").html();e&&(e=$.trim(e.replace(/<br>/gi,""))),this.resetForm(),f=this.obj.children(".workEdit").children("form").clone(),f.find(".workLink").val(d),f.find(".workDescription").val(e),f.find(".word_count").children("span").text(100-f.find(".workDescription").val().length),f.find(".showId").val(c),a.parents("li").prepend(f),placeholderFn(),a.parents("li").children(".workList").addClass("dn"),i(),j(this.obj)},Del:function(a){var b=a.parents("li").attr("data-id");$.ajax({url:ctx+"/workShow/delws.json",type:"POST",data:{id:b}}).done(function(b){b.success?(a.parents("li").remove(),$("ul.slist li:last-child").addClass("noborder"),(""==b.content.workShows||null==b.content.workShows)&&(h.obj.children(".workShow").addClass("dn"),h.obj.children(".workEdit").addClass("dn"),h.obj.children(".workAdd").removeClass("dn"),h.obj.children(".c_add").addClass("dn")),$("#lastChangedTime span").text(b.content.refreshTime),$("#resumeScore .which div").text(b.content.infoCompleteStatus.msg),$("#resumeScore .which span").attr("rel",b.content.infoCompleteStatus.nextStage),scoreChange(b.content.infoCompleteStatus.score),k(h.obj),b.content.isNew&&changeAllIds(b.content.jsonIds)):alert(b.msg)})},AddCancel:function(){this.obj.find(".workAdd").removeClass("dn"),this.obj.find(".workShow").addClass("dn"),this.obj.find(".workEdit").addClass("dn"),k(this.obj)},AddMoreCancel:function(a){a.parents(".workForm").siblings(".workList").removeClass("dn"),a.parents(".workForm").remove(),0==$("ul.slist li").length&&$(".workAdd").removeClass("dn"),k(this.obj)}},h.obj.find(".slist li:last-child").addClass("noborder"),h.obj.find(".workAdd").bind("click",function(){h.Add()}),h.obj.find(".c_add").bind("click",function(){h.AddMore(),$(this).addClass("dn")}),h.obj.on("click",".sm_edit",function(){h.Edit($(this))}),h.obj.on("click",".sm_del",function(){confirm("确认要删除吗？")&&h.Del($(this))}),h.obj.children(".workShow").on({mouseenter:function(){$(this).children(".slist").find(".sm_del,.sm_edit").removeClass("dn")},mouseleave:function(){$(this).children(".slist").find(".sm_del,.sm_edit").addClass("dn")}}),h.obj.children(".workEdit").find(".btn_profile_cancel").bind("click",function(){h.AddCancel()}),h.obj.children(".workShow").on("click",".btn_profile_cancel",function(){h.AddMoreCancel($(this)),h.obj.find(".c_add").removeClass("dn")}),h.obj.on("keyup",".s_textarea",function(){var a=$(this);$.trim(a.val()).length>100?a.val($.trim(a.val()).substring(0,100)):a.next(".word_count").children("span").text(100-$.trim(a.val()).length)}),i(),$("#resumeSet h2 span").bind("click",function(){a=!1;var b=$(this).parents("#resumeSet");$.ajax({url:ctx+"/mycenter/resume/getAllResumes.json",type:"GET"}).done(function(a){a.success?(a.content[0].isDefault&&(b.find(".resume0").click(),b.children(".defaultResume").val(a.content[0].type)),a.content[1].isDefault&&(b.find(".resume1").click(),b.children(".defaultResume").val(a.content[1].type),a.content[1].perfect||(b.find(".setTip").text("在线简历还未达可投递标准，请完善后选择").show(),b.find(".btn_profile_save").attr("disabled","disabled"))),a.content[0].perfect||a.content[1].perfect||(b.find(".setTip").text("你还没有可投递的简历").show(),b.find(".btn_profile_save").attr("disabled","disabled")),b.children(".noSet").hide(),b.children("#resumeSetForm").removeClass("dn"),b.children("#resumeSetForm").find('input[type="radio"]').bind("click",function(){1!=$(this).val()||a.content[1].perfect?0!=$(this).val()||a.content[0].perfect?(b.find(".setTip").text("").hide(),b.find(".btn_profile_save").removeAttr("disabled")):(b.find(".setTip").text("你还没有附件线简历，请上传后选择").show(),b.find(".btn_profile_save").attr("disabled","disabled")):(b.find(".setTip").text("在线简历还未达可投递标准，请完善后选择").show(),b.find(".btn_profile_save").attr("disabled","disabled"))})):alert(a.msg)})}),$("#resumeSetForm .btn_profile_cancel").bind("click",function(){var b=$(this).parents("#resumeSet"),c=b.children(".defaultResume").val();-1==c?(b.children(".noSet").show(),b.children(".set0").hide(),b.children(".set1").hide(),b.children("#resumeSetForm").addClass("dn")):(b.children(".noSet").hide(),b.children(".set"+c).show(),b.children("#resumeSetForm").addClass("dn")),a=!0}),$("#resumeSetForm").validate({rules:{resume:{required:!0}},messages:{resume:{required:"请选择默认投递的简历"}},errorPlacement:function(a,b){a.insertBefore($(b).parents("#resumeSetForm").children(".resumeTip"))},submitHandler:function(b){var c=$('input[name="resume"]:checked',b).val();$(b).find(":submit").attr("disabled",!0),$.ajax({url:ctx+"/mycenter/resume/setDefaultResume.json",type:"POST",data:{type:c}}).done(function(d){d.success?(a=!0,$("#resumeSet .noSet").hide(),$("#resumeSet .set"+c).show(),$("#resumeSet .defaultResume").val(c),$("#resumeSetForm").addClass("dn")):alert(d.msg),$(b).find(":submit").attr("disabled",!1)})}}),$("#myResume").on("click",".resumeUploadDiv a.del",function(){confirm("你确定要删除该附件吗？删除后你设置的默认投递简历也将失效")&&$.ajax({url:ctx+"/nearBy/delNearBy.json",type:"GET"}).done(function(a){a.success?($("#myResume h2 a").html("上传简历"),$("#myResume .resumeUploadDiv").html("暂无附件简历")):alert(a.msg)})})}),$(window).load(function(){scoreChange($("#resumeScore .scoreVal span").text())});